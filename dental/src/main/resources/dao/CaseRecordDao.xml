<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ricky.dentalclinic.dental.dao.CaseRecordDao">
    <select id="listCaseRecord" resultType="com.ricky.dentalclinic.dental.domain.CaseRecordParam">
        SELECT tcr.*, tc.name as case_name, tu.name dentist_name
        FROM
        t_case_record tcr
        LEFT JOIN
        t_case tc
        ON
        tcr.case_id = tc.id
        LEFT JOIN
        t_user tu
        ON
        tcr.dentist_id = tu.id
        WHERE
        tcr.is_delete = 0
        <if test="queryParam.caseName != null and queryParam.caseName != ''">
            AND tc.name LIKE concat("%",#{queryParam.caseName},"%")
        </if>
        <if test="queryParam.dentistName != null and queryParam.dentistName != ''">
            AND tu.name LIKE concat("%",#{queryParam.dentistName},"%")
        </if>
        <if test="queryParam.date != null and queryParam.date != ''">
            AND tcr.date LIKE concat("%",#{queryParam.date},"%")
        </if>
        <if test="queryParam.caseNo != null and queryParam.caseNo != ''">
            AND tcr.case_no LIKE concat("%",#{queryParam.caseNo},"%")
        </if>
        ORDER BY
        tcr.date
    </select>
</mapper>